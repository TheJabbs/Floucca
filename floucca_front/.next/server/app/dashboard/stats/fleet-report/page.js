(()=>{var e={};e.id=181,e.ids=[181],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},95799:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),r(87924),r(13321),r(9813),r(35866);var a=r(23191),s=r(88716),l=r(37922),o=r.n(l),i=r(95231),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);r.d(t,n);let d=["",{children:["dashboard",{children:["stats",{children:["fleet-report",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,87924)),"D:\\seniorproject\\Floucca\\Floucca\\floucca_front\\app\\dashboard\\stats\\fleet-report\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,13321)),"D:\\seniorproject\\Floucca\\Floucca\\floucca_front\\app\\dashboard\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,9813)),"D:\\seniorproject\\Floucca\\Floucca\\floucca_front\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["D:\\seniorproject\\Floucca\\Floucca\\floucca_front\\app\\dashboard\\stats\\fleet-report\\page.tsx"],u="/dashboard/stats/fleet-report/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/dashboard/stats/fleet-report/page",pathname:"/dashboard/stats/fleet-report",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},55005:(e,t,r)=>{Promise.resolve().then(r.bind(r,73395))},73395:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(10326),s=r(17577),l=r(31798),o=r(77449),i=r(86890);let n=async e=>{try{return console.log("Sending fleet report filter to API:",e),(await i.x1.post("/api/dev/fleet_senses/report",e)).data}catch(e){return(0,i.zG)(e,"fetching fleet report")}};var d=r(6862);let c=({data:e,isLoading:t,activeTab:r,setActiveTab:l})=>{let o=e=>e.map(e=>{let t={key:`${e.gear_code}-${e.gear_name.replace(/\s+/g,"-")}`,gear_code:e.gear_code,gear_name:e.gear_name};return["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"].forEach(a=>{if(e[a]){let s=e[a];t[a]="frequency"===r?s.freq:s.activeDays}else t[a]="0"}),t}),i=(0,s.useMemo)(()=>o(e),[e,r]),n=(0,s.useMemo)(()=>[{key:"gear_name",header:"GEAR"},{key:"jan",header:"JAN"},{key:"feb",header:"FEB"},{key:"mar",header:"MAR"},{key:"apr",header:"APR"},{key:"may",header:"MAY"},{key:"jun",header:"JUN"},{key:"jul",header:"JUL"},{key:"aug",header:"AUG"},{key:"sep",header:"SEP"},{key:"oct",header:"OCT"},{key:"nov",header:"NOV"},{key:"dec",header:"DEC"}],[]);return 0!==e.length||t?(0,a.jsxs)("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-4 border-b",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Fleet Gear Usage"}),(0,a.jsxs)("div",{className:"flex border rounded-md overflow-hidden",children:[a.jsx("button",{onClick:()=>l("frequency"),className:`px-4 py-2 text-sm font-medium ${"frequency"===r?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Frequency"}),a.jsx("button",{onClick:()=>l("activeDays"),className:`px-4 py-2 text-sm font-medium ${"activeDays"===r?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Active Days"})]})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"frequency"===r?"Showing frequency of gear usage per month":"Showing active days of gear usage per month"})]}),a.jsx(d.Z,{columns:n,data:i,isLoading:t,noDataMessage:"No gear usage data available. Please select filters and generate the report.",keyExtractor:e=>e.key})]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg border shadow-sm overflow-x-auto",children:[a.jsx("h2",{className:"text-lg font-semibold p-4 border-b",children:"Fleet Gear Usage"}),a.jsx("div",{className:"p-8 text-center text-gray-500",children:"No gear usage data available. Please select filters and generate the report."})]})},u=()=>{let{ports:e,regions:t,coops:r,isLoading:i,error:d}=(0,o.B)(),[u,p]=(0,s.useState)(new Date().getFullYear().toString()),[m,x]=(0,s.useState)("port"),[h,g]=(0,s.useState)([]),[b,y]=(0,s.useState)([]),[f,v]=(0,s.useState)([]),[j,w]=(0,s.useState)([]),[N,k]=(0,s.useState)(!1),[_,q]=(0,s.useState)(null),[F,P]=(0,s.useState)("frequency"),S=new Date().getFullYear(),C=Array.from({length:11},(e,t)=>S-t),D=e=>{h.includes(e)?g(h.filter(t=>t!==e)):g([...h,e])},A=e=>{b.includes(e)?y(b.filter(t=>t!==e)):y([...b,e])},M=e=>{f.includes(e)?v(f.filter(t=>t!==e)):v([...f,e])},Z=()=>{if(!u)return!1;switch(m){case"port":return h.length>0;case"region":return b.length>0;case"coop":return f.length>0;default:return!1}},G=e=>{let t=new Map;return e.forEach(e=>{t.has(e.gear_code)||t.set(e.gear_code,{gear_code:e.gear_code,gear_name:e.gear_name});let r={1:"jan",2:"feb",3:"mar",4:"apr",5:"may",6:"jun",7:"jul",8:"aug",9:"sep",10:"oct",11:"nov",12:"dec"}[e.month];r&&(t.get(e.gear_code)[r]={freq:e.freq,activeDays:e.activeDays})}),Array.from(t.values())},$=async()=>{if(Z()){k(!0),q(null);try{let e=await n({period:u,port_id:"port"===m?h:void 0,coop:"coop"===m?f:void 0,region:"region"===m?b:void 0}),t=G(e);w(t)}catch(e){console.error("Error fetching fleet report:",e),q("string"==typeof e?e:"Failed to fetch fleet report data")}finally{k(!1)}}};return i?a.jsx("div",{className:"flex justify-center py-10",children:a.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"})}):d?a.jsx("div",{className:"container mx-auto p-6",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-800 p-4 rounded-lg",children:[a.jsx("p",{children:d}),a.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md",children:"Try Again"})]})}):(0,a.jsxs)("div",{className:"container mx-auto p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Fleet Gear Usage Report"}),(0,a.jsxs)("button",{onClick:$,disabled:!Z(),className:"px-3 py-2 rounded-lg flex items-center gap-1 text-sm bg-blue-600 hover:bg-blue-700 text-white",children:[a.jsx(l.Z,{className:"h-4 w-4"}),a.jsx("span",{children:"Refresh Data"})]})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg border shadow-sm mb-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"w-full md:w-1/3",children:[a.jsx("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-700 mb-1",children:"Year:"}),(0,a.jsxs)("select",{id:"year",value:u,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Select a year"}),C.map(e=>a.jsx("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter By:"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"button",onClick:()=>x("port"),className:`px-3 py-2 rounded-lg text-sm font-medium ${"port"===m?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"by Port"}),a.jsx("button",{type:"button",onClick:()=>x("region"),className:`px-3 py-2 rounded-lg text-sm font-medium ${"region"===m?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"by Region"}),a.jsx("button",{type:"button",onClick:()=>x("coop"),className:`px-3 py-2 rounded-lg text-sm font-medium ${"coop"===m?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"by Cooperative"})]})]})]}),"port"===m&&(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Ports:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(e=>a.jsx("button",{onClick:()=>D(e.port_id),className:`px-3 py-1 text-sm rounded-lg border ${h.includes(e.port_id)?"bg-blue-100 border-blue-500 text-blue-800":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:e.port_name},e.port_id))})]}),"region"===m&&(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Regions:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(e=>a.jsx("button",{onClick:()=>A(e.region_code),className:`px-3 py-1 text-sm rounded-lg border ${b.includes(e.region_code)?"bg-blue-100 border-blue-500 text-blue-800":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:e.region_name},e.region_code))})]}),"coop"===m&&(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Cooperatives:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(e=>a.jsx("button",{onClick:()=>M(e.coop_code),className:`px-3 py-1 text-sm rounded-lg border ${f.includes(e.coop_code)?"bg-blue-100 border-blue-500 text-blue-800":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:e.coop_name},e.coop_code))})]}),a.jsx("div",{className:"mt-6 flex justify-end",children:a.jsx("button",{onClick:$,disabled:!Z(),className:`px-4 py-2 rounded-lg text-white font-medium ${Z()?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 cursor-not-allowed"}`,children:"Generate Report"})})]}),_&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 p-4 rounded-lg mb-6",children:a.jsx("p",{children:_})}),a.jsx(c,{data:j,isLoading:N,activeTab:F,setActiveTab:P})]})}},6862:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var a=r(10326);r(17577);let s=e=>new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),l=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e),o=({title:e,columns:t,data:r,isLoading:o,noDataMessage:i="No data available",keyExtractor:n})=>{let d=(e,t)=>{if(e.format)return e.format(t);if("number"==typeof t){if(e.key.toLowerCase().includes("avgprice"))return s(t);if(t%1!=0)return l(t)}return t};return(0,a.jsxs)("div",{children:[e&&a.jsx("h3",{className:"text-lg font-semibold mb-3",children:e}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:t.map(e=>a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:e.header},e.key))})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o?a.jsx("tr",{children:a.jsx("td",{colSpan:t.length,className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center",children:a.jsx("div",{className:"flex justify-center py-4",children:a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})})})}):r&&0!==r.length?r.map((e,r)=>a.jsx("tr",{children:t.map(t=>a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d(t,e[t.key])},`${r}-${t.key}`))},n?n(e):r)):a.jsx("tr",{children:a.jsx("td",{colSpan:t.length,className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center",children:i})})})]})})]})}},87924:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(68570).createProxy)(String.raw`D:\seniorproject\Floucca\Floucca\floucca_front\app\dashboard\stats\fleet-report\page.tsx#default`)},14711:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(9664).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},14370:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(9664).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},91118:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(9664).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},6266:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(9664).Z)("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]])},62652:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(9664).Z)("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]])},31798:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(9664).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,786,621,99,981],()=>r(95799));module.exports=a})();