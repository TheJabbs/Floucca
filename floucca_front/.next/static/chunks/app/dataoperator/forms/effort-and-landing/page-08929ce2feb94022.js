(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[679],{4052:function(e,s,t){Promise.resolve().then(t.bind(t,6080))},6080:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return q}});var a=t(7437),r=t(2265),l=t(5775),i=t.n(l),n=t(9501),d=t(1247),c=t(1659),o=t(2839),u=t(9626),m=t(6111),g=t(5361),h=e=>{var s;let{required:t=!1,gears:l,onChange:i}=e,[d,c]=(0,r.useState)(0),[h,f]=(0,r.useState)({}),{register:x,control:p,getValues:_,formState:{errors:y}}=(0,n.cI)({defaultValues:{hours_fished:void 0,gear_entries:[]}}),{fields:b,append:j,remove:v}=(0,n.Dq)({control:p,name:"gear_entries"}),N=()=>{i({hours_fished:_("hours_fished"),gear_entries:b})};(0,r.useEffect)(()=>{N()},[b,_("hours_fished")]);let w=e=>{c(Number(e)),f({})},k=(e,s)=>{f(t=>({...t,[e]:s}))},q=()=>{if(0===d)return;let e=l.find(e=>e.gear_code===d);e&&(j({gear_code:d,gear_details:Object.entries(h).map(s=>{let[t,a]=s;return{detail_name:t,detail_value:a,equipment_id:e.equipment_id||""}})}),c(0),f({}),N())},C=()=>{let e=l.filter(e=>e.gear_code===d);return 0===e.length?[]:e.map(e=>({equipment_id:e.equipment_id,equipment_name:e.equipment_name,type:"number"}))},S=e=>{var s;return(null===(s=l.find(s=>s.gear_code===e))||void 0===s?void 0:s.gear_name)||""},D=()=>C().every(e=>{var s;return null===(s=h[e.equipment_name])||void 0===s?void 0:s.trim()}),L=l.filter(e=>!b.some(s=>s.gear_code===e.gear_code)),P=Array.from(new Set(L.map(e=>e.gear_code))).map(e=>{let s=L.find(s=>s.gear_code===e);return{gear_code:e,gear_name:(null==s?void 0:s.gear_name)||""}});return(0,a.jsxs)("div",{className:"bg-white rounded-lg border p-6 space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-3 text-gray-600",children:(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Effort Today"})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(o.Z,{label:"Hours Fished Today",name:"hours_fished",placeholder:"(1-24 hours)",required:t,type:"number",min:1,max:24,register:x,error:null===(s=y.hours_fished)||void 0===s?void 0:s.message})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Fishing Gear Details",t&&(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("select",{value:d,onChange:e=>w(Number(e.target.value)),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",disabled:b.length===l.length,children:[(0,a.jsx)("option",{value:0,children:"Select Gear"}),P.map(e=>(0,a.jsx)("option",{value:e.gear_code,children:e.gear_name},e.gear_code))]}),0!==d&&(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:C().map(e=>(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:e.equipment_id}),(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:e.equipment_name}),(0,a.jsx)("input",{type:e.type,value:h[e.equipment_name]||"",onChange:s=>k(e.equipment_name,s.target.value),onKeyDown:e=>{("-"===e.key||"e"===e.key)&&e.preventDefault()},min:0,className:"flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter ".concat(e.equipment_name.toLowerCase())}),(0,a.jsxs)("button",{onClick:q,disabled:!D(),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",type:"button",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Add Gear"]})]})},e.equipment_id))})]})]}),b.length>0?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:"Added Gear"}),(0,a.jsx)("div",{className:"divide-y divide-gray-100 space-y-3",children:b.map((e,s)=>(0,a.jsx)("div",{className:"p-4 bg-gray-50 rounded-lg transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:S(e.gear_code)}),(0,a.jsx)("div",{className:"text-sm text-gray-600 flex flex-wrap gap-2",children:e.gear_details.map(e=>(0,a.jsxs)("span",{className:"bg-gray-100 px-2 py-1 rounded-md flex items-center gap-1",children:[(0,a.jsx)("span",{className:"text-xs bg-blue-100 text-blue-700 px-1 rounded",children:e.equipment_id}),(0,a.jsxs)("span",{className:"font-medium",children:[e.detail_name,":"]}),e.detail_value]},e.detail_name))})]}),(0,a.jsx)("button",{onClick:()=>{v(s),N()},className:"p-2 text-red-500 hover:text-red-700 rounded-full hover:bg-red-50 transition-colors",type:"button",children:(0,a.jsx)(m.Z,{className:"w-4 h-4"})})]})},e.id))})]}):(0,a.jsxs)("div",{className:"text-gray-500 italic text-center py-3 flex items-center justify-center gap-2",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4"}),"No gear added yet."]})]})]})},f=e=>{let{required:s=!1,gears:t,onChange:l}=e,[i,d]=(0,r.useState)({gear_code:0,days_used:1}),{control:c}=(0,n.cI)({defaultValues:{gear_entries:[]}}),{fields:o,append:h,remove:f}=(0,n.Dq)({control:c,name:"gear_entries"});(0,r.useEffect)(()=>{l({gear_entries:o})},[o,l]);let x=t.filter(e=>!o.some(s=>s.gear_code===e.gear_code)),p=e=>{d(s=>({...s,gear_code:Number(e)}))},_=e=>{var s;return(null===(s=t.find(s=>s.gear_code===e))||void 0===s?void 0:s.gear_name)||""},y=0===i.gear_code||i.days_used<1||i.days_used>7;return(0,a.jsxs)("div",{className:"bg-white rounded-lg border p-6 space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-3 text-gray-600",children:(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Effort Last Week"})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Select Gear Used Last Week",s&&(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{value:i.gear_code,onChange:e=>p(Number(e.target.value)),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",disabled:0===x.length,children:[(0,a.jsx)("option",{value:0,children:"Select Gear"}),x.map(e=>(0,a.jsx)("option",{value:e.gear_code,children:e.gear_name},e.gear_code))]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Days Used Last Week",s&&(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"number",min:1,max:7,value:i.days_used,onChange:e=>{let s=parseInt(e.target.value)||1;s>=1&&s<=7&&d(e=>({...e,days_used:s}))},placeholder:"1 to 7",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:"(1-7 days)"})]})]})]}),(0,a.jsxs)("button",{onClick:()=>{0===i.gear_code||i.days_used<1||i.days_used>7||(h(i),d({gear_code:0,days_used:1}))},disabled:y,className:"mt-4 inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",type:"button",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Add Gear Usage"]})]}),o.length>0?(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:"Added Gear Usage"}),(0,a.jsx)("div",{className:"divide-y divide-gray-100 space-y-3",children:o.map((e,s)=>(0,a.jsx)("div",{className:"p-4 bg-gray-50 rounded-lg transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:_(e.gear_code)}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Used for ",e.days_used," day",e.days_used>1?"s":""," last week"]})]}),(0,a.jsx)("button",{onClick:()=>f(s),className:"p-2 text-red-500 hover:text-red-700 rounded-full hover:bg-red-50 transition-colors",type:"button",children:(0,a.jsx)(m.Z,{className:"w-4 h-4"})})]})},e.id))})]}):(0,a.jsxs)("div",{className:"text-gray-500 italic text-center py-1 flex items-center justify-center gap-2",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4"}),"No gear usage recorded yet."]})]})]})},x=t(2603),p=t(9776),_=t(9447),y=t(7136),b=t(5108),j=t(4578),v=t(4986);let N=(0,t(6471).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var w=e=>{var s,t,l,i,d,c,g,h;let{required:f=!1,todaysGears:x,selectedLocation:p,gears:_,species:y,onChange:b}=e,[j,w]=(0,r.useState)(""),[k,q]=(0,r.useState)(!1),[C,S]=(0,r.useState)(null),[D,L]=(0,r.useState)(!1),[P,E]=(0,r.useState)([]),{register:F,control:O,watch:T,reset:Z,getValues:G,setValue:A,formState:{errors:I}}=(0,n.cI)({defaultValues:{current:{gear_code:"",specie_code:"",fish_weight:"",fish_length:"",fish_quantity:"",price:""},fish_entries:[]}}),{fields:W,append:M,remove:U}=(0,n.Dq)({control:O,name:"fish_entries"}),R=T("current");(0,r.useEffect)(()=>{let e=R.gear_code;""!==e&&e?L(!0):L(!1)},[R.gear_code]),(0,r.useEffect)(()=>{let e=W.map(e=>({...e}));b({fish_entries:e}),E(e.map(e=>e.specie_code))},[W,b]);let B=y.filter(e=>!P.includes(e.specie_code)).filter(e=>e.specie_name.toLowerCase().includes(j.toLowerCase())),z=()=>{A("current.gear_code",""),A("current.specie_code",""),A("current.fish_weight",""),A("current.fish_length",""),A("current.fish_quantity",""),A("current.price",""),S(null),w(""),q(!1),L(!1)},V=e=>{let s=""!==e.gear_code&&"0"!==e.gear_code&&0!==e.gear_code;return!!s&&p&&s&&e.specie_code&&""!==e.specie_code&&e.fish_weight&&e.fish_length&&e.fish_quantity&&e.price},J=e=>{A("current.specie_code",e.specie_code),S(e),q(!1),w("")},H=e=>{U(e)},K=e=>{let s=_.find(s=>s.gear_code===e);if(s)return s.gear_name;let t=x.find(s=>s.gear_code===e);if(t){if(t.gear_details&&t.gear_details.length>0){let e=t.gear_details.find(e=>"name"===e.detail_name.toLowerCase());if(e)return e.detail_value}return"Gear ".concat(t.gear_code)}return"Unknown Gear (".concat(e,")")},Q=e=>{let s=y.find(s=>s.specie_code===e);return s?s.specie_name:"Species ".concat(e)};return((0,r.useEffect)(()=>{function e(e){e.target.closest(".species-dropdown")||q(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),p)?(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-3 text-gray-600",children:(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Fishing Details Today"})}),(0,a.jsxs)("div",{className:"grid gap-6",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:["Fishing Gear ",f&&(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{...F("current.gear_code",{onChange:e=>{e.target.value?L(!0):(L(!1),A("current.specie_code",""),A("current.fish_weight",""),A("current.fish_length",""),A("current.fish_quantity",""),A("current.price",""),S(null))}}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[(0,a.jsx)("option",{value:"",children:"Select Gear"}),x.map(e=>(0,a.jsx)("option",{value:e.gear_code,children:K(e.gear_code)},e.gear_code))]})]}),D&&(0,a.jsxs)("div",{className:"form-group species-dropdown",children:[(0,a.jsxs)("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:["Fish Species ",f&&(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white flex items-center justify-between cursor-pointer",onClick:()=>q(!k),children:C?(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsx)("span",{children:C.specie_name}),(0,a.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),S(null),A("current.specie_code","")},className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(v.Z,{size:16})})]}):(0,a.jsx)("span",{className:"text-gray-500",children:"Search for species..."})}),k&&(0,a.jsxs)("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[(0,a.jsx)("div",{className:"sticky top-0 bg-white p-2 border-b",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:j,onChange:e=>w(e.target.value),placeholder:"Search species...",className:"w-full pl-8 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:e=>e.stopPropagation()}),(0,a.jsx)(N,{className:"absolute left-2 top-2.5 text-gray-400",size:16})]})}),0===B.length?(0,a.jsx)("div",{className:"p-3 text-center text-gray-500",children:P.length===y.length?"All species have been added":"No species found matching search"}):B.map(e=>(0,a.jsx)("div",{className:"px-3 py-2 hover:bg-blue-50 cursor-pointer",onClick:s=>{s.preventDefault(),s.stopPropagation(),J(e)},children:e.specie_name},e.specie_code))]}),(0,a.jsx)("input",{type:"hidden",...F("current.specie_code")})]})]})]}),D&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)(o.Z,{label:"Weight (kg)",name:"current.fish_weight",placeholder:"Fish weight",type:"number",required:f,register:F,error:null===(t=I.current)||void 0===t?void 0:null===(s=t.fish_weight)||void 0===s?void 0:s.message})}),(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)(o.Z,{label:"Length (cm)",name:"current.fish_length",placeholder:"Fish length",type:"number",required:f,register:F,error:null===(i=I.current)||void 0===i?void 0:null===(l=i.fish_length)||void 0===l?void 0:l.message})}),(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)(o.Z,{label:"Quantity",name:"current.fish_quantity",placeholder:"Fish quantity",type:"number",required:f,register:F,error:null===(c=I.current)||void 0===c?void 0:null===(d=c.fish_quantity)||void 0===d?void 0:d.message})}),(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)(o.Z,{label:"Price (LBP)",name:"current.price",placeholder:"Enter price",type:"number",required:f,register:F,error:null===(h=I.current)||void 0===h?void 0:null===(g=h.price)||void 0===g?void 0:g.message})})]}),(0,a.jsxs)("button",{onClick:()=>{let e=G("current");V(e)&&p&&(M({location_id:p.id,gear_code:Number(e.gear_code),specie_code:Number(e.specie_code),fish_weight:Number(e.fish_weight),fish_length:Number(e.fish_length),fish_quantity:Number(e.fish_quantity),price:Number(e.price)}),z())},disabled:!V(R),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",type:"button",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Add Entry"]})]})]}),W.length>0?(0,a.jsxs)("div",{className:"space-y-4 mt-6",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-700",children:"Added Entries"}),(0,a.jsx)("div",{className:"divide-y divide-gray-100 space-y-3",children:W.map((e,s)=>(0,a.jsx)("div",{className:"p-4 bg-gray-50 rounded-lg transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 flex-1",children:[(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsx)("span",{className:"text-gray-900 ",children:Q(e.specie_code)})}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsx)("span",{className:"text-gray-600 ",children:K(e.gear_code)})}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsxs)("span",{className:"text-gray-600 truncate",children:[e.fish_weight,"kg, ",e.fish_quantity," fish"]})}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsxs)("span",{className:"text-gray-600 truncate",children:[e.fish_length,"cm"]})}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsxs)("span",{className:"text-gray-600 truncate",children:[e.price," LBP"]})})]}),(0,a.jsx)("button",{onClick:()=>H(s),className:"p-2 text-red-500 hover:text-red-700 rounded-full hover:bg-red-50 transition-colors",type:"button",children:(0,a.jsx)(m.Z,{className:"w-4 h-4"})})]})},e.id))})]}):(0,a.jsx)("div",{className:"text-gray-500 italic text-center py-1",children:"No fish entries added yet."})]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-3 text-gray-600",children:(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Fishing Details Today"})}),(0,a.jsx)("p",{className:"mt-4 text-gray-500 italic flex items-center gap-2",children:"Please select a location on the map first."})]})};let k=i()(()=>Promise.all([t.e(641),t.e(212),t.e(749)]).then(t.bind(t,7749)),{loadableGenerated:{webpack:()=>[7749]},ssr:!1});var q=function(){let{selectedPort:e}=(0,p.A)(),{gears:s,species:t,ports:l,isLoading:i,error:o,refetch:u}=(0,d.P)(),m={LandingFormDTO:{port:e,boatData:{fleet_owner:"",fleet_registration:0,fleet_hp:0,fleet_crew:0,fleet_max_weight:0,fleet_length:0},effortTodayData:{hours_fished:0,gear_entries:[]},effortLastWeekData:{gear_entries:[]},location:null,fishingDetails:{fish_entries:[]}}},{handleSubmit:g,setValue:v,reset:N,formState:{isSubmitting:q}}=(0,n.cI)({defaultValues:m}),[C,S]=(0,r.useState)(null),[D,L]=(0,r.useState)([]),[P,E]=(0,r.useState)(!1),[F,O]=(0,r.useState)(!1),[T,Z]=(0,r.useState)(0),[G,A]=(0,r.useState)(null),[I,W]=(0,r.useState)(!1),[M,U]=(0,r.useState)({port:!1,boatInfo:!1,effortToday:null,effortLastWeek:null,location:null,fishingDetails:null}),R=(e,s)=>{U(t=>({...t,[e]:s}))},B=()=>{N(m),S(null),L([]),E(!1),O(!1),U({port:!!e,boatInfo:!1,effortToday:null,effortLastWeek:null,location:null,fishingDetails:null}),Z(e=>e+1)},z=(0,r.useCallback)(()=>{W(!1)},[]),V=(0,r.useCallback)(e=>{v("LandingFormDTO.boatData",e),R("boatInfo",!!e.fleet_owner&&e.fleet_registration>0&&e.fleet_hp>0&&e.fleet_crew>0&&e.fleet_max_weight>0&&e.fleet_length>0)},[v]),J=(0,r.useCallback)(e=>{v("LandingFormDTO.effortTodayData",e);let s=e.hours_fished>0||e.gear_entries.length>0;E(s),R("effortToday",s?e.hours_fished>0&&e.gear_entries.length>0:null),s?L(e.gear_entries):L([]),s||(R("location",null),R("fishingDetails",null))},[v]),H=(0,r.useCallback)(e=>{v("LandingFormDTO.effortLastWeekData",e);let s=e.gear_entries.length>0;O(s),R("effortLastWeek",!!s||null)},[v]),K=(0,r.useCallback)(e=>{v("LandingFormDTO.location",e),S(e),P&&R("location",!!e)},[v,P]),Q=(0,r.useCallback)(e=>{v("LandingFormDTO.fishingDetails",e),P&&R("fishingDetails",e.fish_entries.length>0)},[v,P]),Y=async e=>{try{A(null),W(!1);let{port:s,boatData:t,effortTodayData:a,effortLastWeekData:r,location:l,fishingDetails:i}=e.LandingFormDTO;if(!s)throw Error("Port must be selected");let n={form:{port_id:s,user_id:1,fisher_name:t.fleet_owner},boat_details:{fleet_owner:t.fleet_owner||"Unknown",fleet_registration:t.fleet_registration||0,fleet_hp:t.fleet_hp||0,fleet_crew:t.fleet_crew||0,fleet_max_weight:t.fleet_max_weight||0,fleet_length:t.fleet_length||0}};l&&l.lat&&l.lng&&(n.landing={latitude:l.lat,longitude:l.lng}),P&&(i.fish_entries&&i.fish_entries.length>0&&(n.fish=i.fish_entries.map(e=>({specie_code:e.specie_code,gear_code:e.gear_code,fish_weight:e.fish_weight,fish_length:e.fish_length,fish_quantity:e.fish_quantity,price:e.price||0}))),a.hours_fished>0&&(n.effort={hours_fished:a.hours_fished}),a.gear_entries&&a.gear_entries.length>0&&(n.gearDetail=a.gear_entries.flatMap(e=>e.gear_details.map(s=>({gear_code:e.gear_code,detail_name:s.detail_name,detail_value:s.detail_value}))))),F&&r.gear_entries.length>0&&(n.lastw=r.gear_entries.map(e=>({gear_code:e.gear_code,days_fished:e.days_used}))),console.log("Submitting API payload:",JSON.stringify(n,null,2));let d=await (0,b.DE)(n);console.log("API Response:",d),(0,j.nZ)("flouca_submissions"),(0,j.nZ)("flouca_submissions_timestamp"),A({type:"success",message:"Form submitted successfully! Your data has been recorded."}),W(!0),B()}catch(s){console.error("Error submitting form:",s);let e="There was an error submitting the form. Please try again.";s instanceof Error?e=s.message:"object"==typeof s&&null!==s&&(e=JSON.stringify(s)),A({type:"error",message:e}),W(!0)}};return((0,r.useEffect)(()=>{v("LandingFormDTO.port",e),R("port",!!e)},[e,v]),i)?(0,a.jsx)("div",{className:"flex justify-center py-10",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"})}):o?(0,a.jsx)("div",{className:"container mx-auto p-6",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg",children:[(0,a.jsx)("p",{children:o}),(0,a.jsx)("button",{onClick:()=>u(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md",children:"Try Again"})]})}):(0,a.jsxs)("div",{className:"container mx-auto p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Landing Form"}),(0,a.jsx)("div",{className:"w-72",children:(0,a.jsx)(_.Z,{ports:l})})]}),(0,a.jsxs)("form",{onSubmit:g(Y),className:"space-y-6",children:[(0,a.jsx)(c.Z,{required:!1,onChange:V},"boat-info-".concat(T)),(0,a.jsx)(f,{required:!1,onChange:H,gears:s},"effort-last-week-".concat(T)),(0,a.jsx)(h,{required:!1,onChange:J,gears:s},"effort-today-".concat(T)),P&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k,{required:!0,onChange:K},"map-markers-".concat(T)),(0,a.jsx)(w,{required:!0,selectedLocation:C,todaysGears:D,gears:s,species:t,onChange:Q},"fishing-details-".concat(T))]}),(0,a.jsx)(x.Z,{isSubmitting:q,disabled:!(!P&&!F||!P||M.location&&M.fishingDetails),label:"Submit"})]}),G&&(0,a.jsx)(y.Z,{type:G.type,message:G.message,isVisible:I,onClose:z})]})}},5775:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return l}});let a=t(7043);t(7437),t(2265);let r=a._(t(5602));function l(e,s){var t;let a={loading:e=>{let{error:s,isLoading:t,pastDelay:a}=e;return null}};"function"==typeof e&&(a.loader=e);let l={...a,...s};return(0,r.default)({...l,modules:null==(t=l.loadableGenerated)?void 0:t.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),e.exports=s.default)},1523:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return r}});let a=t(8993);function r(e){let{reason:s,children:t}=e;if("undefined"==typeof window)throw new a.BailoutToCSRError(s);return t}},5602:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return c}});let a=t(7437),r=t(2265),l=t(1523),i=t(49);function n(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(n(()=>null)),loading:null,ssr:!0},c=function(e){let s={...d,...e},t=(0,r.lazy)(()=>s.loader().then(n)),c=s.loading;function o(e){let n=c?(0,a.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,d=s.ssr?(0,a.jsxs)(a.Fragment,{children:["undefined"==typeof window?(0,a.jsx)(i.PreloadCss,{moduleIds:s.modules}):null,(0,a.jsx)(t,{...e})]}):(0,a.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(t,{...e})});return(0,a.jsx)(r.Suspense,{fallback:n,children:d})}return o.displayName="LoadableComponent",o}},49:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadCss",{enumerable:!0,get:function(){return l}});let a=t(7437),r=t(544);function l(e){let{moduleIds:s}=e;if("undefined"!=typeof window)return null;let t=(0,r.getExpectedRequestStore)("next/dynamic css"),l=[];if(t.reactLoadableManifest&&s){let e=t.reactLoadableManifest;for(let t of s){if(!e[t])continue;let s=e[t].files.filter(e=>e.endsWith(".css"));l.push(...s)}}return 0===l.length?null:(0,a.jsx)(a.Fragment,{children:l.map(e=>(0,a.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:t.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[464,30,419,971,117,744],function(){return e(e.s=4052)}),_N_E=e.O()}]);