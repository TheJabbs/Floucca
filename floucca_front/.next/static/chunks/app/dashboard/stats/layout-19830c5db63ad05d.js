(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[349],{1919:function(e,t,r){Promise.resolve().then(r.bind(r,746))},746:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var a=r(7437),s=r(2265),n=r(4023),o=r(6471);let c=(0,o.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),i=(0,o.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),l=(0,o.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),d=[{type:"Ports",records:12,period:"2024 01 B"},{type:"Coops",records:30,period:"2024 01 B"},{type:"Region",records:30,period:"2024 01 B"},{type:"Boats and gears",records:12,period:"2024 01 B"},{type:"Species",records:121,period:"2024 01 B"},{type:"Weight and Value Units",records:"Kg , LBP",period:"2024 01 B"},{type:"Boat Details",records:1,period:"2024 01 B"},{type:"Effort Today",records:4,period:"2024 01 B"},{type:"Estimates",records:5,period:"2024 01 B"},{type:"Ports",records:12,period:"2023 12 B"},{type:"Coops",records:28,period:"2023 12 B"},{type:"Region",records:30,period:"2023 12 B"},{type:"Species",records:118,period:"2023 12 B"}],u=Array.from(new Set(d.map(e=>e.period)));var p=()=>{let[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(Object.fromEntries(u.map(e=>[e,!0]))),[o,p]=(0,s.useState)(null),[f,h]=(0,s.useState)(!1),g=e=>{n(t=>({...t,[e]:!t[e]}))},m=e=>{p(e),h(!1)},x=o?d.filter(e=>e.period===o):d,y=e=>d.filter(t=>t.period===e);return(0,a.jsx)("div",{className:"bg-white border-r border-gray-200 h-full overflow-y-auto transition-all duration-300 ".concat(e?"w-64":"w-24"),onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),children:(0,a.jsx)("div",{className:"p-2",children:e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"font-semibold text-lg",children:"Summaries"}),(0,a.jsx)("button",{onClick:()=>{h(!f)},className:"p-1 rounded hover:bg-gray-100",title:"Filter by period",children:(0,a.jsx)(c,{size:18})})]}),f&&(0,a.jsxs)("div",{className:"mb-4 p-2 bg-gray-50 rounded border",children:[(0,a.jsx)("div",{className:"font-medium mb-2 text-sm",children:"Filter by period:"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"cursor-pointer p-1 rounded text-sm ".concat(null===o?"bg-indigo-100 text-indigo-800":"hover:bg-gray-100"),onClick:()=>m(null),children:"All periods"}),u.map(e=>(0,a.jsx)("div",{className:"cursor-pointer p-1 rounded text-sm ".concat(o===e?"bg-indigo-100 text-indigo-800":"hover:bg-gray-100"),onClick:()=>m(e),children:e},e))]})]}),null===o?(0,a.jsx)("div",{className:"space-y-2",children:u.map(e=>(0,a.jsxs)("div",{className:"border rounded overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-indigo-50 cursor-pointer",onClick:()=>g(e),children:[(0,a.jsx)("span",{className:"font-semibold text-indigo-700",children:e}),r[e]?(0,a.jsx)(i,{size:16,className:"text-indigo-700"}):(0,a.jsx)(l,{size:16,className:"text-indigo-700"})]}),r[e]&&(0,a.jsx)("div",{className:"border-t",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Data type"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Records"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:y(e).map((t,r)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-3 py-2 text-sm text-gray-700",children:t.type}),(0,a.jsx)("td",{className:"px-3 py-2 text-sm text-gray-700",children:t.records})]},"".concat(e,"-").concat(t.type,"-").concat(r)))})]})})]},e))}):(0,a.jsxs)("div",{className:"border rounded overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-indigo-50 p-2",children:(0,a.jsx)("span",{className:"font-semibold text-indigo-700",children:o})}),(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Data type"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Records"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:x.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-3 py-2 text-sm text-gray-700",children:e.type}),(0,a.jsx)("td",{className:"px-3 py-2 text-sm text-gray-700",children:e.records})]},t))})]})]})]}):(0,a.jsx)("div",{className:"flex flex-col items-center",children:(0,a.jsx)("div",{className:"text-center py-3 border-b w-full mb-4",children:(0,a.jsx)("span",{className:"font-bold text-indigo-700 text-sm",children:"Statistics"})})})})})};function f(e){let{children:t}=e;return(0,a.jsx)(n.v,{children:(0,a.jsxs)("div",{className:"flex h-full",children:[(0,a.jsx)("div",{className:"flex h-screen",children:(0,a.jsx)(p,{})}),(0,a.jsx)("div",{className:"flex-1 p-6 overflow-y-auto",children:t})]})})}},4578:function(e,t,r){"use strict";function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:36e5;try{let r=localStorage.getItem("".concat(e,"_timestamp"));if(!r)return!1;let a=parseInt(r,10);return Date.now()-a<t}catch(e){return console.error("Error checking cache validity:",e),!1}}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:36e5;try{if(!a(e,t))return null;let r=localStorage.getItem(e);if(!r)return null;return JSON.parse(r)}catch(e){return console.error("Error retrieving from cache:",e),null}}function n(e,t){try{let r="".concat(e,"_timestamp");localStorage.setItem(e,JSON.stringify(t)),localStorage.setItem(r,Date.now().toString())}catch(e){console.error("Error saving to cache:",e)}}function o(e){try{let t="".concat(e,"_timestamp");localStorage.removeItem(e),localStorage.removeItem(t)}catch(e){console.error("Error removing from cache:",e)}}r.d(t,{TK:function(){return s},cW:function(){return n},kI:function(){return a},nZ:function(){return o}})},4023:function(e,t,r){"use strict";r.d(t,{B:function(){return i},v:function(){return l}});var a=r(7437),s=r(2265),n=r(5108),o=r(3301);let c=(0,s.createContext)(void 0);function i(){let e=(0,s.useContext)(c);if(!e)throw Error("useStatsData must be used within a StatsDataProvider");return e}function l(e){let{children:t}=e,r=(0,o.N)(n.Z7,"flouca_stats_gears"),s=(0,o.N)(n.LH,"flouca_stats_ports"),i=(0,o.N)(n.JL,"flouca_stats_regions"),l=(0,o.N)(n.V$,"flouca_stats_coops"),d=(0,o.N)(n.Kh,"flouca_stats_periods"),u=d.data.map(e=>({value:e.period_date,label:"".concat((0,o.f)(e.period_date).split(" ")[0]," ").concat(e.period_status)})),p=async()=>{await Promise.all([r.refetch(),s.refetch(),i.refetch(),l.refetch(),d.refetch()])},f=r.isLoading||s.isLoading||i.isLoading||l.isLoading||d.isLoading,h=r.error||s.error||i.error||l.error||d.error,g=[r.lastFetched,s.lastFetched,i.lastFetched,l.lastFetched,d.lastFetched].filter(Boolean),m=g.length>0?Math.max(...g):null,x={gears:r.data,ports:s.data,regions:i.data,coops:l.data,periods:d.data,formattedPeriods:u,isLoading:f,error:h,lastFetched:m,refetch:p};return(0,a.jsx)(c.Provider,{value:x,children:t})}},3301:function(e,t,r){"use strict";r.d(t,{N:function(){return o},f:function(){return n}});var a=r(2265),s=r(4578);let n=e=>{let t=new Date(e);return"".concat(t.getDate().toString().padStart(2,"0"),"-").concat((t.getMonth()+1).toString().padStart(2,"0"),"-").concat(t.getFullYear()," ").concat(t.getHours?t.getHours():""," ").concat(e.includes("T")?e.split("T")[1].split(".")[0].substring(0,5):"").trim()},o=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36e5,[n,o]=(0,a.useState)([]),[c,i]=(0,a.useState)(!0),[l,d]=(0,a.useState)(null),[u,p]=(0,a.useState)(null),f=async()=>{try{i(!0),d(null),console.log("Fetching fresh data for ".concat(t,"..."));let r=await e();o(r),(0,s.cW)(t,r),p(Date.now()),console.log("Fresh data for ".concat(t," fetched and cached successfully"))}catch(e){console.error("Error fetching data for ".concat(t,":"),e),d("Failed to load ".concat(t," data. Please try again."))}finally{i(!1)}};return(0,a.useEffect)(()=>{(async()=>{let e=(0,s.TK)(t,r);if(e){console.log("Data for ".concat(t," loaded from cache successfully")),o(e);let r=localStorage.getItem("".concat(t,"_timestamp"));p(r?parseInt(r,10):null),i(!1)}else await f()})()},[t]),{data:n,isLoading:c,error:l,lastFetched:u,refetch:f}}},5084:function(e,t,r){"use strict";r.d(t,{x1:function(){return s},zG:function(){return n}});var a=r(3464);let s=a.Z.create({baseURL:"http://localhost:4000",headers:{"Content-Type":"application/json"}}),n=(e,t)=>{if(console.error("Error ".concat(t,":"),e),a.Z.isAxiosError(e)&&e.response){if(console.error("Error response data:",e.response.data),console.error("Error response status:",e.response.status),e.response.data&&"object"==typeof e.response.data)throw{message:e.response.data.message||"Server error (".concat(t,")"),statusCode:e.response.status,details:e.response.data};throw Error("Server error (".concat(e.response.status,"): ").concat(e.message))}throw Error("Failed to ".concat(t,". Please check your connection and try again."))}},5108:function(e,t,r){"use strict";r.d(t,{V$:function(){return l},Z7:function(){return n},Kh:function(){return c},LH:function(){return s},JL:function(){return i},XZ:function(){return o},PF:function(){return u},DE:function(){return d}});var a=r(5084);let s=async()=>{try{return(await a.x1.get("/ports")).data}catch(e){return(0,a.zG)(e,"fetching ports")}},n=async()=>{try{return(await a.x1.get("/api/dev/gear/all/gear")).data}catch(e){return(0,a.zG)(e,"fetching gears")}},o=async()=>{try{return(await a.x1.get("/species/all")).data}catch(e){return(0,a.zG)(e,"fetching species")}},c=async()=>{try{return(await a.x1.get("/api/dev/period/all/period")).data}catch(e){return(0,a.zG)(e,"fetching periods")}},i=async()=>{try{return(await a.x1.get("/region/all")).data}catch(e){return(0,a.zG)(e,"fetching regions")}},l=async()=>{try{return(await a.x1.get("/api/coop/all")).data}catch(e){return(0,a.zG)(e,"fetching coops")}},d=async e=>{try{let t=JSON.parse(JSON.stringify(e));return console.log("Sending landing data to API:",JSON.stringify(t,null,2)),(await a.x1.post("/api/dev/landings/create/form",t)).data}catch(e){return(0,a.zG)(e,"submitting landing form")}},u=async e=>{try{let t=JSON.parse(JSON.stringify(e));return console.log("Sending fleet senses data to API:",JSON.stringify(t,null,2)),(await a.x1.post("/api/dev/fleet_senses/form/create",t)).data}catch(e){return(0,a.zG)(e,"submitting fleet senses form")}}},6471:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:l="",children:d,iconNode:u,...p}=e;return(0,a.createElement)("svg",{ref:t,...o,width:s,height:s,stroke:r,strokeWidth:i?24*Number(c)/Number(s):c,className:n("lucide",l),...p},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let r=(0,a.forwardRef)((r,o)=>{let{className:i,...l}=r;return(0,a.createElement)(c,{ref:o,iconNode:t,className:n("lucide-".concat(s(e)),i),...l})});return r.displayName="".concat(e),r}}},function(e){e.O(0,[464,971,117,744],function(){return e(e.s=1919)}),_N_E=e.O()}]);