(()=>{var e={};e.id=679,e.ids=[679],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},2440:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>g,tree:()=>o}),t(2535),t(3070),t(4901),t(9813),t(5866);var r=t(3191),a=t(8716),i=t(7922),l=t.n(i),n=t(5231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(s,d);let o=["",{children:["dataoperator",{children:["forms",{children:["effort-and-landing",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,2535)),"/Users/cbf/dev/uob/Floucca/floucca_front/app/dataoperator/forms/effort-and-landing/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,3070)),"/Users/cbf/dev/uob/Floucca/floucca_front/app/dataoperator/forms/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,4901)),"/Users/cbf/dev/uob/Floucca/floucca_front/app/dataoperator/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,9813)),"/Users/cbf/dev/uob/Floucca/floucca_front/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/cbf/dev/uob/Floucca/floucca_front/app/dataoperator/forms/effort-and-landing/page.tsx"],u="/dataoperator/forms/effort-and-landing/page",m={require:t,loadChunk:()=>Promise.resolve()},g=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dataoperator/forms/effort-and-landing/page",pathname:"/dataoperator/forms/effort-and-landing",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9355:(e,s,t)=>{Promise.resolve().then(t.bind(t,4522))},4522:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var r=t(326),a=t(7577),i=t(3353),l=t.n(i),n=t(4723),d=t(4885),o=t(3885),c=t(8787),u=t(1315),m=t(7084),g=t(4926);let f=({required:e=!1,gears:s,onChange:t})=>{let[i,l]=(0,a.useState)(0),[d,o]=(0,a.useState)({}),{register:f,control:p,getValues:h,formState:{errors:x}}=(0,n.cI)({defaultValues:{hours_fished:void 0,gear_entries:[]}}),{fields:_,append:b,remove:y}=(0,n.Dq)({control:p,name:"gear_entries"}),j=()=>{t({hours_fished:h("hours_fished"),gear_entries:_})};(0,a.useEffect)(()=>{j()},[_,h("hours_fished")]);let v=e=>{l(Number(e)),o({})},N=(e,s)=>{o(t=>({...t,[e]:s}))},w=()=>{if(0===i)return;let e=s.find(e=>e.gear_code===i);e&&(b({gear_code:i,gear_details:Object.entries(d).map(([s,t])=>({detail_name:s,detail_value:t,equipment_id:e.equipment_id||""}))}),l(0),o({}),j())},q=()=>{let e=s.filter(e=>e.gear_code===i);return 0===e.length?[]:e.map(e=>({equipment_id:e.equipment_id,equipment_name:e.equipment_name,type:"number"}))},k=e=>s.find(s=>s.gear_code===e)?.gear_name||"",P=()=>q().every(e=>d[e.equipment_name]?.trim()),S=s.filter(e=>!_.some(s=>s.gear_code===e.gear_code)),C=Array.from(new Set(S.map(e=>e.gear_code))).map(e=>{let s=S.find(s=>s.gear_code===e);return{gear_code:e,gear_name:s?.gear_name||""}});return(0,r.jsxs)("div",{className:"bg-white rounded-lg border p-6 space-y-6",children:[r.jsx("div",{className:"flex items-center gap-3 text-gray-600",children:r.jsx("h2",{className:"text-xl font-semibold",children:"Effort Today"})}),(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("div",{className:"flex items-center gap-2",children:r.jsx(c.Z,{label:"Hours Fished Today",name:"hours_fished",placeholder:"(1-24 hours)",required:e,type:"number",min:1,max:24,register:f,error:x.hours_fished?.message})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Fishing Gear Details",e&&r.jsx("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("select",{value:i,onChange:e=>v(Number(e.target.value)),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",disabled:_.length===s.length,children:[r.jsx("option",{value:0,children:"Select Gear"}),C.map(e=>r.jsx("option",{value:e.gear_code,children:e.gear_name},e.gear_code))]}),0!==i&&r.jsx("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:q().map(e=>r.jsx("div",{className:"space-y-2",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:e.equipment_id}),r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e.equipment_name}),r.jsx("input",{type:e.type,value:d[e.equipment_name]||"",onChange:s=>N(e.equipment_name,s.target.value),onKeyDown:e=>{("-"===e.key||"e"===e.key)&&e.preventDefault()},min:0,className:"flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Enter ${e.equipment_name.toLowerCase()}`}),(0,r.jsxs)("button",{onClick:w,disabled:!P(),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",type:"button",children:[r.jsx(u.Z,{className:"w-4 h-4 mr-2"}),"Add Gear"]})]})},e.equipment_id))})]})]}),_.length>0?(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:"Added Gear"}),r.jsx("div",{className:"divide-y divide-gray-100 space-y-3",children:_.map((e,s)=>r.jsx("div",{className:"p-4 bg-gray-50 rounded-lg transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:k(e.gear_code)}),r.jsx("div",{className:"text-sm text-gray-600 flex flex-wrap gap-2",children:e.gear_details.map(e=>(0,r.jsxs)("span",{className:"bg-gray-100 px-2 py-1 rounded-md flex items-center gap-1",children:[r.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-1 rounded",children:e.equipment_id}),(0,r.jsxs)("span",{className:"font-medium",children:[e.detail_name,":"]}),e.detail_value]},e.detail_name))})]}),r.jsx("button",{onClick:()=>{y(s),j()},className:"p-2 text-red-500 hover:text-red-700 rounded-full hover:bg-red-50 transition-colors",type:"button",children:r.jsx(m.Z,{className:"w-4 h-4"})})]})},e.id))})]}):(0,r.jsxs)("div",{className:"text-gray-500 italic text-center py-3 flex items-center justify-center gap-2",children:[r.jsx(g.Z,{className:"w-4 h-4"}),"No gear added yet."]})]})]})},p=({required:e=!1,gears:s,onChange:t})=>{let[i,l]=(0,a.useState)({gear_code:0,days_used:1}),{control:d}=(0,n.cI)({defaultValues:{gear_entries:[]}}),{fields:o,append:c,remove:f}=(0,n.Dq)({control:d,name:"gear_entries"});(0,a.useEffect)(()=>{t({gear_entries:o})},[o,t]);let p=s.filter(e=>!o.some(s=>s.gear_code===e.gear_code)),h=e=>{l(s=>({...s,gear_code:Number(e)}))},x=e=>s.find(s=>s.gear_code===e)?.gear_name||"",_=0===i.gear_code||i.days_used<1||i.days_used>7;return(0,r.jsxs)("div",{className:"bg-white rounded-lg border p-6 space-y-6",children:[r.jsx("div",{className:"flex items-center gap-3 text-gray-600",children:r.jsx("h2",{className:"text-xl font-semibold",children:"Effort Last Week"})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Select Gear Used Last Week",e&&r.jsx("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("select",{value:i.gear_code,onChange:e=>h(Number(e.target.value)),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",disabled:0===p.length,children:[r.jsx("option",{value:0,children:"Select Gear"}),p.map(e=>r.jsx("option",{value:e.gear_code,children:e.gear_name},e.gear_code))]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Days Used Last Week",e&&r.jsx("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"number",min:1,max:7,value:i.days_used,onChange:e=>{let s=parseInt(e.target.value)||1;s>=1&&s<=7&&l(e=>({...e,days_used:s}))},placeholder:"1 to 7",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:"(1-7 days)"})]})]})]}),(0,r.jsxs)("button",{onClick:()=>{0===i.gear_code||i.days_used<1||i.days_used>7||(c(i),l({gear_code:0,days_used:1}))},disabled:_,className:"mt-4 inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",type:"button",children:[r.jsx(u.Z,{className:"w-4 h-4 mr-2"}),"Add Gear Usage"]})]}),o.length>0?(0,r.jsxs)("div",{className:"space-y-1",children:[r.jsx("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:"Added Gear Usage"}),r.jsx("div",{className:"divide-y divide-gray-100 space-y-3",children:o.map((e,s)=>r.jsx("div",{className:"p-4 bg-gray-50 rounded-lg transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:x(e.gear_code)}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Used for ",e.days_used," day",e.days_used>1?"s":""," last week"]})]}),r.jsx("button",{onClick:()=>f(s),className:"p-2 text-red-500 hover:text-red-700 rounded-full hover:bg-red-50 transition-colors",type:"button",children:r.jsx(m.Z,{className:"w-4 h-4"})})]})},e.id))})]}):(0,r.jsxs)("div",{className:"text-gray-500 italic text-center py-1 flex items-center justify-center gap-2",children:[r.jsx(g.Z,{className:"w-4 h-4"}),"No gear usage recorded yet."]})]})]})};var h=t(3258),x=t(380),_=t(8402),b=t(1094),y=t(9570),j=t(9255),v=t(3020);let N=(0,t(9664).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),w=({required:e=!1,todaysGears:s,selectedLocation:t,gears:i,species:l,onChange:d})=>{let[o,g]=(0,a.useState)(""),[f,p]=(0,a.useState)(!1),[h,x]=(0,a.useState)(null),[_,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)([]),{register:w,control:q,watch:k,reset:P,getValues:S,setValue:C,formState:{errors:D}}=(0,n.cI)({defaultValues:{current:{gear_code:"",specie_code:"",fish_weight:"",fish_length:"",fish_quantity:"",price:""},fish_entries:[]}}),{fields:L,append:F,remove:E}=(0,n.Dq)({control:q,name:"fish_entries"}),T=k("current");(0,a.useEffect)(()=>{let e=T.gear_code;""!==e&&e?b(!0):b(!1)},[T.gear_code]),(0,a.useEffect)(()=>{let e=L.map(e=>({...e}));d({fish_entries:e}),j(e.map(e=>e.specie_code))},[L,d]);let G=l.filter(e=>!y.includes(e.specie_code)).filter(e=>e.specie_name.toLowerCase().includes(o.toLowerCase())),O=()=>{C("current.gear_code",""),C("current.specie_code",""),C("current.fish_weight",""),C("current.fish_length",""),C("current.fish_quantity",""),C("current.price",""),x(null),g(""),p(!1),b(!1)},Z=e=>{let s=""!==e.gear_code&&"0"!==e.gear_code&&0!==e.gear_code;return!!s&&t&&s&&e.specie_code&&""!==e.specie_code&&e.fish_weight&&e.fish_length&&e.fish_quantity&&e.price},A=e=>{C("current.specie_code",e.specie_code),x(e),p(!1),g("")},U=e=>{E(e)},M=e=>{let t=i.find(s=>s.gear_code===e);if(t)return t.gear_name;let r=s.find(s=>s.gear_code===e);if(r){if(r.gear_details&&r.gear_details.length>0){let e=r.gear_details.find(e=>"name"===e.detail_name.toLowerCase());if(e)return e.detail_value}return`Gear ${r.gear_code}`}return`Unknown Gear (${e})`},I=e=>{let s=l.find(s=>s.specie_code===e);return s?s.specie_name:`Species ${e}`};return((0,a.useEffect)(()=>{function e(e){e.target.closest(".species-dropdown")||p(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),t)?(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[r.jsx("div",{className:"flex items-center gap-3 text-gray-600",children:r.jsx("h2",{className:"text-xl font-semibold",children:"Fishing Details Today"})}),(0,r.jsxs)("div",{className:"grid gap-6",children:[(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsxs)("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:["Fishing Gear ",e&&r.jsx("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("select",{...w("current.gear_code",{onChange:e=>{e.target.value?b(!0):(b(!1),C("current.specie_code",""),C("current.fish_weight",""),C("current.fish_length",""),C("current.fish_quantity",""),C("current.price",""),x(null))}}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[r.jsx("option",{value:"",children:"Select Gear"}),s.map(e=>r.jsx("option",{value:e.gear_code,children:M(e.gear_code)},e.gear_code))]})]}),_&&(0,r.jsxs)("div",{className:"form-group species-dropdown",children:[(0,r.jsxs)("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:["Fish Species ",e&&r.jsx("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("div",{className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white flex items-center justify-between cursor-pointer",onClick:()=>p(!f),children:h?(0,r.jsxs)("div",{className:"flex items-center justify-between w-full",children:[r.jsx("span",{children:h.specie_name}),r.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),x(null),C("current.specie_code","")},className:"text-gray-500 hover:text-gray-700",children:r.jsx(v.Z,{size:16})})]}):r.jsx("span",{className:"text-gray-500",children:"Search for species..."})}),f&&(0,r.jsxs)("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[r.jsx("div",{className:"sticky top-0 bg-white p-2 border-b",children:(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{type:"text",value:o,onChange:e=>g(e.target.value),placeholder:"Search species...",className:"w-full pl-8 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:e=>e.stopPropagation()}),r.jsx(N,{className:"absolute left-2 top-2.5 text-gray-400",size:16})]})}),0===G.length?r.jsx("div",{className:"p-3 text-center text-gray-500",children:y.length===l.length?"All species have been added":"No species found matching search"}):G.map(e=>r.jsx("div",{className:"px-3 py-2 hover:bg-blue-50 cursor-pointer",onClick:s=>{s.preventDefault(),s.stopPropagation(),A(e)},children:e.specie_name},e.specie_code))]}),r.jsx("input",{type:"hidden",...w("current.specie_code")})]})]})]}),_&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[r.jsx("div",{className:"space-y-1",children:r.jsx(c.Z,{label:"Weight (kg)",name:"current.fish_weight",placeholder:"Fish weight",type:"number",required:e,register:w,error:D.current?.fish_weight?.message})}),r.jsx("div",{className:"space-y-1",children:r.jsx(c.Z,{label:"Length (cm)",name:"current.fish_length",placeholder:"Fish length",type:"number",required:e,register:w,error:D.current?.fish_length?.message})}),r.jsx("div",{className:"space-y-1",children:r.jsx(c.Z,{label:"Quantity",name:"current.fish_quantity",placeholder:"Fish quantity",type:"number",required:e,register:w,error:D.current?.fish_quantity?.message})}),r.jsx("div",{className:"space-y-1",children:r.jsx(c.Z,{label:"Price (LBP)",name:"current.price",placeholder:"Enter price",type:"number",required:e,register:w,error:D.current?.price?.message})})]}),(0,r.jsxs)("button",{onClick:()=>{let e=S("current");Z(e)&&t&&(F({location_id:t.id,gear_code:Number(e.gear_code),specie_code:Number(e.specie_code),fish_weight:Number(e.fish_weight),fish_length:Number(e.fish_length),fish_quantity:Number(e.fish_quantity),price:Number(e.price)}),O())},disabled:!Z(T),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",type:"button",children:[r.jsx(u.Z,{className:"w-4 h-4 mr-2"}),"Add Entry"]})]})]}),L.length>0?(0,r.jsxs)("div",{className:"space-y-4 mt-6",children:[r.jsx("h3",{className:"font-medium text-gray-700",children:"Added Entries"}),r.jsx("div",{className:"divide-y divide-gray-100 space-y-3",children:L.map((e,s)=>r.jsx("div",{className:"p-4 bg-gray-50 rounded-lg transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 flex-1",children:[r.jsx("div",{className:"flex items-center gap-1",children:r.jsx("span",{className:"text-gray-900 ",children:I(e.specie_code)})}),r.jsx("div",{className:"flex items-center gap-1",children:r.jsx("span",{className:"text-gray-600 ",children:M(e.gear_code)})}),r.jsx("div",{className:"flex items-center gap-1",children:(0,r.jsxs)("span",{className:"text-gray-600 truncate",children:[e.fish_weight,"kg, ",e.fish_quantity," fish"]})}),r.jsx("div",{className:"flex items-center gap-1",children:(0,r.jsxs)("span",{className:"text-gray-600 truncate",children:[e.fish_length,"cm"]})}),r.jsx("div",{className:"flex items-center gap-1",children:(0,r.jsxs)("span",{className:"text-gray-600 truncate",children:[e.price," LBP"]})})]}),r.jsx("button",{onClick:()=>U(s),className:"p-2 text-red-500 hover:text-red-700 rounded-full hover:bg-red-50 transition-colors",type:"button",children:r.jsx(m.Z,{className:"w-4 h-4"})})]})},e.id))})]}):r.jsx("div",{className:"text-gray-500 italic text-center py-1",children:"No fish entries added yet."})]}):(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("div",{className:"flex items-center gap-3 text-gray-600",children:r.jsx("h2",{className:"text-xl font-semibold",children:"Fishing Details Today"})}),r.jsx("p",{className:"mt-4 text-gray-500 italic flex items-center gap-2",children:"Please select a location on the map first."})]})},q=l()(async()=>{},{loadableGenerated:{modules:["app/dataoperator/forms/effort-and-landing/page.tsx -> @/components/forms-c/map-with-markers"]},ssr:!1}),k=function(){let{selectedPort:e}=(0,x.A)(),{gears:s,species:t,ports:i,isLoading:l,error:c,refetch:u}=(0,d.P)(),m={LandingFormDTO:{port:e,boatData:{fleet_owner:"",fleet_registration:0,fleet_hp:0,fleet_crew:0,fleet_max_weight:0,fleet_length:0},effortTodayData:{hours_fished:0,gear_entries:[]},effortLastWeekData:{gear_entries:[]},location:null,fishingDetails:{fish_entries:[]}}},{handleSubmit:g,setValue:v,reset:N,formState:{isSubmitting:k}}=(0,n.cI)({defaultValues:m}),[P,S]=(0,a.useState)(null),[C,D]=(0,a.useState)([]),[L,F]=(0,a.useState)(!1),[E,T]=(0,a.useState)(!1),[G,O]=(0,a.useState)(0),[Z,A]=(0,a.useState)(null),[U,M]=(0,a.useState)(!1),[I,$]=(0,a.useState)({port:!1,boatInfo:!1,effortToday:null,effortLastWeek:null,location:null,fishingDetails:null}),W=(e,s)=>{$(t=>({...t,[e]:s}))},R=()=>{N(m),S(null),D([]),F(!1),T(!1),$({port:!!e,boatInfo:!1,effortToday:null,effortLastWeek:null,location:null,fishingDetails:null}),O(e=>e+1)},z=(0,a.useCallback)(()=>{M(!1)},[]),B=(0,a.useCallback)(e=>{v("LandingFormDTO.boatData",e),W("boatInfo",!!e.fleet_owner&&e.fleet_registration>0&&e.fleet_hp>0&&e.fleet_crew>0&&e.fleet_max_weight>0&&e.fleet_length>0)},[v]),V=(0,a.useCallback)(e=>{v("LandingFormDTO.effortTodayData",e);let s=e.hours_fished>0||e.gear_entries.length>0;F(s),W("effortToday",s?e.hours_fished>0&&e.gear_entries.length>0:null),s?D(e.gear_entries):D([]),s||(W("location",null),W("fishingDetails",null))},[v]),J=(0,a.useCallback)(e=>{v("LandingFormDTO.effortLastWeekData",e);let s=e.gear_entries.length>0;T(s),W("effortLastWeek",!!s||null)},[v]),H=(0,a.useCallback)(e=>{v("LandingFormDTO.location",e),S(e),L&&W("location",!!e)},[v,L]),K=(0,a.useCallback)(e=>{v("LandingFormDTO.fishingDetails",e),L&&W("fishingDetails",e.fish_entries.length>0)},[v,L]),Q=async e=>{try{A(null),M(!1);let{port:s,boatData:t,effortTodayData:r,effortLastWeekData:a,location:i,fishingDetails:l}=e.LandingFormDTO;if(!s)throw Error("Port must be selected");let n={form:{port_id:s,user_id:1,fisher_name:t.fleet_owner},boat_details:{fleet_owner:t.fleet_owner||"Unknown",fleet_registration:t.fleet_registration||0,fleet_hp:t.fleet_hp||0,fleet_crew:t.fleet_crew||0,fleet_max_weight:t.fleet_max_weight||0,fleet_length:t.fleet_length||0}};i&&i.lat&&i.lng&&(n.landing={latitude:i.lat,longitude:i.lng}),L&&(l.fish_entries&&l.fish_entries.length>0&&(n.fish=l.fish_entries.map(e=>({specie_code:e.specie_code,gear_code:e.gear_code,fish_weight:e.fish_weight,fish_length:e.fish_length,fish_quantity:e.fish_quantity,price:e.price||0}))),r.hours_fished>0&&(n.effort={hours_fished:r.hours_fished}),r.gear_entries&&r.gear_entries.length>0&&(n.gearDetail=r.gear_entries.flatMap(e=>e.gear_details.map(s=>({gear_code:e.gear_code,detail_name:s.detail_name,detail_value:s.detail_value}))))),E&&a.gear_entries.length>0&&(n.lastw=a.gear_entries.map(e=>({gear_code:e.gear_code,days_fished:e.days_used}))),console.log("Submitting API payload:",JSON.stringify(n,null,2));let d=await (0,y.DE)(n);console.log("API Response:",d),(0,j.nZ)("flouca_submissions"),(0,j.nZ)("flouca_submissions_timestamp"),A({type:"success",message:"Form submitted successfully! Your data has been recorded."}),M(!0),R()}catch(s){console.error("Error submitting form:",s);let e="There was an error submitting the form. Please try again.";s instanceof Error?e=s.message:"object"==typeof s&&null!==s&&(e=JSON.stringify(s)),A({type:"error",message:e}),M(!0)}};return l?r.jsx("div",{className:"flex justify-center py-10",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"})}):c?r.jsx("div",{className:"container mx-auto p-6",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg",children:[r.jsx("p",{children:c}),r.jsx("button",{onClick:()=>u(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md",children:"Try Again"})]})}):(0,r.jsxs)("div",{className:"container mx-auto p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Landing Form"}),r.jsx("div",{className:"w-72",children:r.jsx(_.Z,{ports:i})})]}),(0,r.jsxs)("form",{onSubmit:g(Q),className:"space-y-6",children:[r.jsx(o.Z,{required:!1,onChange:B},`boat-info-${G}`),r.jsx(p,{required:!1,onChange:J,gears:s},`effort-last-week-${G}`),r.jsx(f,{required:!1,onChange:V,gears:s},`effort-today-${G}`),L&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(q,{required:!0,onChange:H},`map-markers-${G}`),r.jsx(w,{required:!0,selectedLocation:P,todaysGears:C,gears:s,species:t,onChange:K},`fishing-details-${G}`)]}),r.jsx(h.Z,{isSubmitting:k,disabled:!(!L&&!E||!L||I.location&&I.fishingDetails),label:"Submit"})]}),Z&&r.jsx(b.Z,{type:Z.type,message:Z.message,isVisible:U,onClose:z})]})}},3353:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return i}});let r=t(1174);t(326),t(7577);let a=r._(t(7028));function i(e,s){var t;let r={loading:e=>{let{error:s,isLoading:t,pastDelay:r}=e;return null}};"function"==typeof e&&(r.loader=e);let i={...r,...s};return(0,a.default)({...i,modules:null==(t=i.loadableGenerated)?void 0:t.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),e.exports=s.default)},933:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let r=t(4129);function a(e){let{reason:s,children:t}=e;throw new r.BailoutToCSRError(s)}},7028:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return o}});let r=t(326),a=t(7577),i=t(933),l=t(6618);function n(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(n(()=>null)),loading:null,ssr:!0},o=function(e){let s={...d,...e},t=(0,a.lazy)(()=>s.loader().then(n)),o=s.loading;function c(e){let n=o?(0,r.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,d=s.ssr?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.PreloadCss,{moduleIds:s.modules}),(0,r.jsx)(t,{...e})]}):(0,r.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(t,{...e})});return(0,r.jsx)(a.Suspense,{fallback:n,children:d})}return c.displayName="LoadableComponent",c}},6618:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadCss",{enumerable:!0,get:function(){return i}});let r=t(326),a=t(5403);function i(e){let{moduleIds:s}=e,t=(0,a.getExpectedRequestStore)("next/dynamic css"),i=[];if(t.reactLoadableManifest&&s){let e=t.reactLoadableManifest;for(let t of s){if(!e[t])continue;let s=e[t].files.filter(e=>e.endsWith(".css"));i.push(...s)}}return 0===i.length?null:(0,r.jsx)(r.Fragment,{children:i.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:t.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},2535:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>i,default:()=>n});var r=t(8570);let a=(0,r.createProxy)(String.raw`/Users/cbf/dev/uob/Floucca/floucca_front/app/dataoperator/forms/effort-and-landing/page.tsx`),{__esModule:i,$$typeof:l}=a;a.default;let n=(0,r.createProxy)(String.raw`/Users/cbf/dev/uob/Floucca/floucca_front/app/dataoperator/forms/effort-and-landing/page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[948,505,621,99,308,45],()=>t(2440));module.exports=r})();